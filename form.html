<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f0f8ff; /* Màu xanh lá cây nhạt */
      padding: 20px;
    }
    input[type="text"], select, textarea {
      width: 100%;
      padding: 8px;
      margin: 5px 0;
      box-sizing: border-box;
    }
    input[type="submit"] {
      background-color: #4CAF50; /* Màu xanh lá cây */
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    input[type="submit"]:hover {
      background-color: #45a049; /* Màu xanh lá cây tối */
    }
  </style>
</head>
<body>
  <h2>Biểu mẫu nhập thông tin</h2>
  <form onsubmit="handleSubmit(event)">
    <label for="lineName">Tên line người order:</label><br>
    <input type="text" id="lineName" name="lineName" required><br>

    <label for="studentEmail">Email học viên:</label><br>
    <input type="text" id="studentEmail" name="studentEmail" required><br>

     <label for="studentaccount">Link facebook/pancake học viên:</label><br>
    <input type="text" id="studentaccount" name="studentaccount" required><br>

    <label for="level">Cấp độ:</label><br>
    <select id="level" name="level" required>
      <option value="N5">N5</option>
      <option value="N4">N4</option>
      <option value="N3">N3</option>
      <option value="N2">N2</option>
      <option value="N1">N1</option>
    </select><br>

    <label for="product">Sản phẩm:</label><br>
    <select id="product" name="product" required>
      <option value="VIP15">VIP15</option>
      <option value="VIP100">VIP100</option>
      <option value="VIP500">VIP500</option>
      <option value="Kaiwa">Kaiwa</option>
      <option value="FOSFT">FOSFT</option>
    </select><br>

     <label for="studentClass">Lớp học viên. VD: 010124:</label><br>
    <input type="text" id="studentClass" name="studentClass" required><br>

    <label for="channel">Phòng ban - Bộ phận:</label><br>
    <select id="channel" name="channel" required>
      <option value="Sale">Sale</option>
      <option value="Trợ giảng">Trợ giảng</option>
    </select><br>

    <label for="issue">Loại issue:</label><br>
    <select id="issue" name="issue" required>
      <option value="Bảo lưu">Bảo lưu</option>
      <option value="Chuyển lớp">Chuyển lớp</option>
      <option value="Hoàn Phí">Hoàn Phí</option>
      <option value="Tạo lớp BE">Tạo lớp BE</option>
      <option value="Hướng dẫn học">Hướng dẫn học</option>
      <option value="Check thông tin">Check thông tin</option>
      <option value="Khác">Khác</option>
    </select><br>

    <label for="description">Mô tả chi tiết:</label><br>
    <textarea id="description" name="description" rows="4" required></textarea><br>

    <label for="priority">Mức độ ưu tiên:</label><br>
    <select id="priority" name="priority" required>
      <option value="Gấp">Gấp</option>
      <option value="Bình thường">Bình thường</option>
      <option value="Ưu tiên thấp">Ưu tiên thấp</option>
      <option value="Khác">Khác</option>
    </select><br>

    <input type="submit" value="Submit">
  </form>

  <script>
    // Hàm xử lý sự kiện khi submit biểu mẫu
    function handleSubmit(event) {
      event.preventDefault(); // Ngăn chặn gửi form mặc định
      
      // Lấy dữ liệu từ biểu mẫu
      var formData = {
        lineName: document.getElementById('lineName').value,
        studentEmail: document.getElementById('studentEmail').value,
        studentaccount: document.getElementById('studentaccount').value,
        level: document.getElementById('level').value,
        product: document.getElementById('product').value,
        studentClass: document.getElementById('studentClass').value,
        channel: document.getElementById('channel').value,
        issue: document.getElementById('issue').value,
        description: document.getElementById('description').value,
        priority: document.getElementById('priority').value
      };
      
      // Gọi hàm submitForm từ Google Apps Script và truyền formData như một đối số
      google.script.run.onSubmit(formData);
      //  google.script.run.onsubmit(formData);
      // Sau khi submit, xóa nội dung trong các trường nhập liệu
      document.getElementById('lineName').value = '';
      document.getElementById('studentEmail').value = '';
      document.getElementById('studentaccount').value = '';
      document.getElementById('level').value = '';
      document.getElementById('product').value = '';
      document.getElementById('studentClass').value = '';
      document.getElementById('channel').value = '';
      document.getElementById('issue').value = '';
      document.getElementById('description').value = '';
      document.getElementById('priority').value = '';
    }
  </script>
</body>
</html>
